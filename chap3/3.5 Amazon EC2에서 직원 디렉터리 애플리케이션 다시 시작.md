## 데모: Amazon EC2에서 직원 디렉터리 애플리케이션 다시 시작

### 📌 현재 VPC 네트워크 및 EC2 배포 흐름
#### 1. VPC 생성

- **이름**: app-vpc

- **CIDR 범위**: 10.1.0.0/16

- 리전: ap-northeast-2 (서울)

---

#### 2. 서브넷 생성 (총 4개)

- **퍼블릭 서브넷 1** → ap-northeast-2a, CIDR: 10.1.1.0/24

- **프라이빗 서브넷 1** → ap-northeast-2a, CIDR: 10.1.2.0/24

- **퍼블릭 서브넷 2** → ap-northeast-2b, CIDR: 10.1.3.0/24

- **프라이빗 서브넷 2** → ap-northeast-2b, CIDR: 10.1.4.0/24

---

#### 3. 인터넷 게이트웨이(IGW)

- **이름**: app-igw

- **VPC 연결**: app-vpc

- **특징**: 1:1 관계 (하나의 IGW ↔ 하나의 VPC)

---

#### 4. 라우팅 테이블

- **이름**: public-route-table

- 연결된 VPC: app-vpc

- **라우팅 규칙**:

    - Local → VPC 내부 통신 (자동 생성)

    - 0.0.0.0/0 → Target: app-igw (인터넷 트래픽 허용)

- **서브넷 연결**: Public Subnet 1, Public Subnet 2

---

5. 보안 그룹

- **이름**: app-sg (새 VPC용 생성)

- 인바운드 규칙:

    - HTTP (TCP 80) → 0.0.0.0/0 허용

    - HTTPS (TCP 443) → 0.0.0.0/0 허용

- 아웃바운드 규칙: 모든 트래픽 허용 (기본값)

---

6. EC2 인스턴스 (직원 디렉터리 앱)

- **AMI**: Amazon Linux 2

- **타입**: t3.micro (프리 티어)

- **VPC**: app-vpc

- **서브넷**: Public Subnet 1

- **퍼블릭 IP**: 자동 할당 (Enabled)

- **보안 그룹**: app-sg

- **User Data 스크립트**:
    EC2 서버 생성시 사용하는 스크립트 
    ```
    #!/bin/bash -ex
    wget https://aws-tc-largeobjects.s3-us-west-2.amazonaws.com/DEV-AWS-MO-GCNv2/FlaskApp.zip
    unzip FlaskApp.zip
    cd FlaskApp/
    yum -y install python3-pip
    pip install -r requirements.txt
    yum -y install stress
    export PHOTOS_BUCKET=employee-photo-bucket-sr-888
    export AWS_DEFAULT_REGION=ap-northeast-2
    export DYNAMO_MODE=on
    FLASK_APP=application.py /usr/local/bin/flask run --host=0.0.0.0 --port=80
    ```

7. 최종 결과

- 새 app-vpc 내에서 직원 디렉터리 앱 EC2 인스턴스가 실행됨.

- 브라우저에서 인스턴스의 퍼블릭 IP로 접속 가능.

- 퍼블릭 서브넷 → IGW → 인터넷 접근 정상 동작 확인 완료.

---

#### 👉 지금 상태는 VPC + 2개의 AZ, 4개의 서브넷 + IGW + 라우팅 테이블 + 보안 그룹 + EC2가 모두 구성된 완전한 네트워크 아키텍처입니다.

### AWS Skill Bulder Lab 참조
[Introduction to Amazon Virtual Private Cloud (VPC) (한국어)](https://skillbuilder.aws/learn/PH6Z6EVH8Z/introduction-to-amazon-virtual-private-cloud-vpc-/KQTDYUWHXN)
